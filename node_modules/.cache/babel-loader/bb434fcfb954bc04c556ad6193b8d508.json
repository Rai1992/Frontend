{"ast":null,"code":"/*\r\n * Copyright (c) 2015-present, Vitaly Tomilov\r\n *\r\n * See the LICENSE file at the top-level directory of this distribution\r\n * for licensing information.\r\n *\r\n * Removal or modification of this copyright notice is prohibited.\r\n */\n'use strict';\n/**\r\n * @class ConnectionContext\r\n * @private\r\n * @summary Internal connection context.\r\n *\r\n * @param {object} cc\r\n * Connection Context.\r\n *\r\n * @param {object} cc.cn\r\n * Connection details\r\n *\r\n * @param {*} cc.dc\r\n * Database Context\r\n *\r\n * @param {object} cc.options\r\n * Library's Initialization Options\r\n *\r\n * @param {object} cc.db\r\n * Database Session we're attached to, if any.\r\n *\r\n * @param {number} cc.level\r\n * Task Level\r\n *\r\n * @param {number} cc.txLevel\r\n * Transaction Level\r\n *\r\n * @param {object} cc.parentCtx\r\n * Connection Context of the parent operation, if any.\r\n *\r\n */\n\nclass ConnectionContext {\n  constructor(cc) {\n    this.cn = cc.cn; // connection details;\n\n    this.dc = cc.dc; // database context;\n\n    this.options = cc.options; // library options;\n\n    this.db = cc.db; // database session;\n\n    this.level = cc.level; // task level;\n\n    this.txLevel = cc.txLevel; // transaction level;\n\n    this.parentCtx = null; // parent context\n\n    this.taskCtx = null; // task context\n\n    this.start = null; // Date/Time when connected\n  }\n\n  connect(db) {\n    this.db = db;\n    this.start = new Date();\n  }\n\n  disconnect(err) {\n    if (this.db) {\n      this.db.done(err);\n      this.db = null;\n    }\n  }\n\n  clone() {\n    const obj = new ConnectionContext(this);\n    obj.parentCtx = this.taskCtx;\n    return obj;\n  }\n\n}\n/**\r\n * Connection Context\r\n * @module context\r\n * @author Vitaly Tomilov\r\n * @private\r\n */\n\n\nmodule.exports = ConnectionContext;","map":null,"metadata":{},"sourceType":"script"}