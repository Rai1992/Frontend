{"ast":null,"code":"'use strict';\n\nconst _ = require('lodash');\n/**\n * Transforms a record or records which contain a \"body\" field into a document\n * object or objects. Metadata is removed and the \"id\" field is moved into the\n * body.\n *\n * @module util/docify\n * @param {Array|Object} result - A record or list of records to transform.\n * @return {Array|Object} The transformed record or records.\n */\n\n\nexports = module.exports = function (result) {\n  /**\n   * Transforms a single record containing a \"body\" field into a document object.\n   *\n   * @param {Object} row - A flat object representing a database record.\n   * @return {Object} A document object generated from the row.\n   */\n  function docify(row) {\n    if (row == null) {\n      return null;\n    }\n\n    if (row.body) {\n      const returnDoc = _.cloneDeep(row.body);\n\n      returnDoc.id = row.id;\n      returnDoc.created_at = row.created_at;\n      returnDoc.updated_at = row.updated_at;\n      return returnDoc;\n    }\n\n    return row;\n  }\n\n  if (_.isArray(result)) {\n    return result.map(docify);\n  }\n\n  return docify(result);\n};","map":null,"metadata":{},"sourceType":"script"}